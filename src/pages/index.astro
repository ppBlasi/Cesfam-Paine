---
import Layout from '../layouts/Layout.astro';
---

<Layout title="CESFAM">
  <section class="bg-gradient-to-b from-[#200934] via-[#2d1250] to-[#200934] py-16">
    <div class="mx-auto flex max-w-6xl flex-col gap-10 px-4 sm:px-6 text-white">

      <header class="text-center">
        <p class="text-sm uppercase tracking-widest text-white/70">Bienvenido al sistema del CESFAM Dr Miguel Solar de Paine</p>
        <h1 class="mt-3 text-4xl font-bold sm:text-5xl">Accede a tu portal de salud</h1>
        <p class="mt-4 max-w-2xl mx-auto text-white/80">
          Gestiona tus reservas, revisa información importante y mantente al día con las novedades del CESFAM.
        </p>

        <a
          href="/login"
          class="inline-block mt-6 rounded-2xl bg-white/90 px-8 py-3 text-[#200934] font-semibold shadow-lg transition hover:bg-white"
        >
          Inicia sesión aquí
        </a>
      </header>


      <section class="grid grid-cols-1 gap-6 md:grid-cols-2 mt-6">

        <article class="rounded-3xl bg-white/95 p-6 shadow-2xl backdrop-blur">
          <div class="bg-[#200934] text-white text-center py-2 rounded-xl font-semibold shadow-md">
            Campaña informativa
          </div>
          <img class="h-[9rem] w-full object-cover rounded-xl mt-4 shadow-md"
               src="/index/campana.webp" alt="campaña" />
        </article>

        <article class="rounded-3xl bg-white/95 p-6 shadow-2xl backdrop-blur">
          <div class="bg-[#200934] text-white text-center py-2 rounded-xl font-semibold shadow-md">
            Vacúnate a tiempo
          </div>
          <img class="h-[9rem] w-full object-cover rounded-xl mt-4 shadow-md"
               src="/index/vacunate.webp" alt="vacunate" />
        </article>

      </section>


      <section class="rounded-3xl bg-white/95 shadow-2xl backdrop-blur p-4">
        <div class="relative overflow-hidden rounded-2xl">
          <div
        class="js-carousel relative w-full h-[28rem] flex items-center"
        role="region"
        aria-roledescription="carousel"
        aria-label="Carrusel de imágenes"
        tabindex="0"
          >
        <div class="js-track flex w-full h-full transition-transform duration-500 will-change-transform">
          <div class="min-w-full h-full flex-shrink-0">
            <img class="w-full h-full object-cover rounded-2xl shadow-lg" src="/index/hospital1.jpg" alt="Hospital" />
          </div>
          <div class="min-w-full h-full flex-shrink-0">
            <img class="w-full h-full object-cover rounded-2xl shadow-lg" src="/index/hosp2.webp" alt="Hospital" />
          </div>
          <div class="min-w-full h-full flex-shrink-0">
            <img class="w-full h-full object-cover rounded-2xl shadow-lg" src="/index/hops3.webp" alt="Hospital" />
          </div>
        </div>

        <button
          class="js-prev absolute left-3 top-1/2 -translate-y-1/2 z-10 rounded-full bg-white/90 p-2 shadow-md disabled:opacity-40"
          aria-label="Anterior"
        >
          <svg class="w-5 h-5 text-[#200934]" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>

        <button
          class="js-next absolute right-3 top-1/2 -translate-y-1/2 z-10 rounded-full bg-white/90 p-2 shadow-md disabled:opacity-40"
          aria-label="Siguiente"
        >
          <svg class="w-5 h-5 text-[#200934]" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>

        <div class="js-dots absolute bottom-3 left-1/2 -translate-x-1/2 z-10 flex gap-2" aria-hidden="false"></div>
          </div>
        </div>

        <script type="module">
          (function() {
        const carousel = document.querySelector('.js-carousel');
        if (!carousel) return;
        const track = carousel.querySelector('.js-track');
        const slides = Array.from(track.children);
        const prevBtn = carousel.querySelector('.js-prev');
        const nextBtn = carousel.querySelector('.js-next');
        const dotsContainer = carousel.querySelector('.js-dots');
        let index = 0;

        // Create dots
        slides.forEach((_, i) => {
          const btn = document.createElement('button');
          btn.className = 'w-2.5 h-2.5 rounded-full bg-white/60 shadow-sm transition-opacity';
          btn.setAttribute('aria-label', `Ir a la imagen ${i + 1}`);
          btn.addEventListener('click', () => {
            index = i;
            update();
          });
          dotsContainer.appendChild(btn);
        });

        function update() {
          track.style.transform = `translateX(-${index * 100}%)`;
          prevBtn.disabled = index === 0;
          nextBtn.disabled = index === slides.length - 1;

          dotsContainer.querySelectorAll('button').forEach((b, i) => {
            b.classList.toggle('bg-white', i === index);
            b.classList.toggle('bg-white/60', i !== index);
            b.setAttribute('aria-current', i === index ? 'true' : 'false');
          });
        }

        prevBtn.addEventListener('click', () => {
          if (index > 0) index--;
          update();
        });

        nextBtn.addEventListener('click', () => {
          if (index < slides.length - 1) index++;
          update();
        });

        carousel.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') {
            e.preventDefault();
            if (index > 0) index--;
            update();
          } else if (e.key === 'ArrowRight') {
            e.preventDefault();
            if (index < slides.length - 1) index++;
            update();
          }
        });

        update();
          })();
        </script>
      </section>


      <section class="grid grid-cols-1 gap-6 md:grid-cols-2">

  <article class="rounded-3xl bg-white/95 shadow-2xl backdrop-blur p-6">
    <a href="/noticia">
      <div class="bg-[#200934] text-white text-center py-2 rounded-xl font-semibold shadow-md cursor-pointer">
        Noticias
      </div>
    </a>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4">
      <img class="h-[9rem] w-full object-cover rounded-xl shadow-md cursor-pointer js-zoom-img"
           src="/noticias/sm.jpg" alt="Noticia 1" />
      <img class="h-[9rem] w-full object-cover rounded-xl shadow-md cursor-pointer js-zoom-img"
           src="/noticias/ds.jpg" alt="Noticia 2" />
      <img class="h-[9rem] w-full object-cover rounded-xl shadow-md cursor-pointer js-zoom-img"
           src="/noticias/ginem.jpg" alt="Noticia 3" />
    </div>
  </article>

  <article class="rounded-3xl bg-white/95 shadow-2xl backdrop-blur p-6">
    <a href="/vidasana">
      <div class="bg-[#200934] text-white text-center py-2 rounded-xl font-semibold shadow-md cursor-pointer">
        Vida Sana
      </div>
    </a>

    <div class="flex justify-center mt-4">
      <img
        class="h-[11rem] w-[22rem] max-w-full object-cover rounded-xl shadow-md cursor-pointer js-zoom-img"
        src="/noticias/sal.jpg"
        alt="alimentación"
      />
    </div>
  </article>

  </section>

    <div id="zoomModal"
        class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden p-4">
      <img id="zoomImg" class="max-w-full max-h-full rounded-xl shadow-2xl" src="" alt="zoom" />
    </div>

        <script>
          // Guard and type safety for DOM elements; toggle flex-related classes from JS
          const zoomModal = /** @type {HTMLElement | null} */ (document.getElementById('zoomModal'));
          const zoomImg = /** @type {HTMLImageElement | null} */ (document.getElementById('zoomImg'));

          if (zoomModal && zoomImg) {
            document.querySelectorAll('.js-zoom-img').forEach((el) => {
              if (!(el instanceof HTMLImageElement)) return;
              const img = /** @type {HTMLImageElement} */ (el);
              img.addEventListener('click', () => {
                if (!zoomImg) return;
                zoomImg.src = img.src;
                zoomModal.classList.remove('hidden');
                zoomModal.classList.add('flex', 'items-center', 'justify-center');
              });
            });

            zoomModal.addEventListener('click', () => {
              zoomModal.classList.add('hidden');
              zoomModal.classList.remove('flex', 'items-center', 'justify-center');
            });

            document.addEventListener('keydown', (e) => {
              if (e.key === 'Escape') {
                zoomModal.classList.add('hidden');
                zoomModal.classList.remove('flex', 'items-center', 'justify-center');
              }
            });
          }
        </script>

          
      </div>
    </section>
</Layout>
